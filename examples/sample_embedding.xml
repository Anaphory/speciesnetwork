<?xml version='1.0' encoding='UTF-8'?>
<beast namespace="beast.core:beast.evolution.alignment:beast.evolution.tree.coalescent:beast.core.util:beast.evolution.nuc:beast.evolution.operators:beast.evolution.sitemodel:beast.evolution.substitutionmodel:beast.evolution.likelihood" version="2.0">
  <data id="gene1" name="alignment">
    <sequence id="gene1_speciesA_tip1" taxon="speciesA_tip1" totalcount="4" value="-" />
    <sequence id="gene1_speciesA_tip2" taxon="speciesA_tip2" totalcount="4" value="-" />
    <sequence id="gene1_speciesB_tip1" taxon="speciesB_tip1" totalcount="4" value="-" />
    <sequence id="gene1_speciesB_tip2" taxon="speciesB_tip2" totalcount="4" value="-" />
    <sequence id="gene1_speciesC_tip1" taxon="speciesC_tip1" totalcount="4" value="-" />
    <sequence id="gene1_speciesC_tip2" taxon="speciesC_tip2" totalcount="4" value="-" />
  </data>

  <map name="Uniform">beast.math.distributions.Uniform</map>
  <map name="Exponential">beast.math.distributions.Exponential</map>
  <map name="LogNormal">beast.math.distributions.LogNormalDistributionModel</map>
  <map name="Normal">beast.math.distributions.Normal</map>
  <map name="Beta">beast.math.distributions.Beta</map>
  <map name="Gamma">beast.math.distributions.Gamma</map>
  <map name="LaplaceDistribution">beast.math.distributions.LaplaceDistribution</map>
  <map name="prior">beast.math.distributions.Prior</map>
  <map name="InverseGamma">beast.math.distributions.InverseGamma</map>
  <map name="OneOnX">beast.math.distributions.OneOnX</map>

  <init spec='beast.util.TreeParser' id='tree:species' IsLabelledNewick="true" adjustTipHeights="false" newick="((speciesA:0.2,#H1:0.1)d:0.3,((speciesB:0.1)#H1:0.2,speciesC:0.3)e:0.2)f"/>

  <run chainLength="1000000" id="mcmc" spec="MCMC" storeEvery="100">
    <state id="state" storeEvery="100">
      <stateNode id="network:species" spec="speciesnetwork.NetworkParser" tree="@tree:species">
        <taxonset id="taxonSuperset" spec="TaxonSet">
          <taxon id="speciesA" spec="TaxonSet">
            <taxon id="speciesA_tip1" spec="Taxon" />
            <taxon id="speciesA_tip2" spec="Taxon" />
          </taxon>
          <taxon id="speciesB" spec="TaxonSet">
            <taxon id="speciesB_tip1" spec="Taxon" />
            <taxon id="speciesB_tip2" spec="Taxon" />
          </taxon>
          <taxon id="speciesC" spec="TaxonSet">
            <taxon id="speciesC_tip1" spec="Taxon" />
            <taxon id="speciesC_tip2" spec="Taxon" />
          </taxon>
        </taxonset>
      </stateNode>
      <tree id="tree:gene1" name="stateNode">
        <taxonset alignment="@gene1" id="TaxonSet:gene1" spec="TaxonSet" />
      </tree>
      <parameter id="gammaP" lower="0.0" upper="1.0" estimate="false" name="stateNode">0.5</parameter>
      <stateNode id="embedding:gene1" spec="parameter.IntegerParameter">-1</stateNode>
    </state>

    <init estimate="false" id="initializer" method="random" spec="speciesnetwork.StarBeastInitializer" speciesNetwork="@network:species" geneTree="@tree:gene1" rebuildEmbedding="@rebuildEmbedding">
      <populationModel alpha="2.0" beta="1.0" id="popModel" spec="speciesnetwork.ConstantPopulationIO" />
    </init>

    <distribution id="posterior" spec="util.CompoundDistribution">
      <distribution id="speciescoalescent" populationModel="@popModel" spec="speciesnetwork.MultispeciesCoalescent" speciesNetwork="@network:species">
        <geneTree id="geneTree:gene1" ploidy="2.0" spec="speciesnetwork.GeneTreeInSpeciesNetwork" speciesNetwork="@network:species" geneTree="@tree:gene1" embedding="@embedding:gene1" gamma="@gammaP"/>
      </distribution>
      <distribution id="prior" spec="util.CompoundDistribution">
      </distribution>
      <distribution id="likelihood" spec="util.CompoundDistribution">
        <distribution data="@gene1" id="likelihood:gene1" spec="TreeLikelihood" tree="@tree:gene1">
          <siteModel gammaCategoryCount="4" id="siteModel:gene1" mutationRate="1.0" proportionInvariant="0.0" spec="SiteModel">
            <substModel id="jc:gene1" spec="JukesCantor"/>
          </siteModel>
          <branchRateModel clock.rate="1.0" id="clock:gene1" spec="beast.evolution.branchratemodel.StrictClockModel" />
        </distribution>
      </distribution>
    </distribution>

    <operator id="rebuildEmbedding" spec="speciesnetwork.RebuildEmbedding" geneTree="@tree:gene1" speciesNetwork="@network:species" taxonSuperset="@taxonSuperset" embedding="@embedding:gene1" weight="1.0"/>

    <logger fileName="embedding.log" id="tracelog" logEvery="100" model="@posterior" sort="smart">
      <log idref="posterior" />
      <log idref="speciescoalescent" />
      <log idref="prior" />
      <log idref="likelihood" />
      <log idref="likelihood:gene1" />
    </logger>
    <logger fileName="embedding.gene1.log" id="tracelog:gene1" logEvery="100" model="@posterior" sort="smart">
      <log idref="embedding:gene1" />
    </logger>
    <logger id="screenlog" logEvery="100" model="@posterior">
      <log idref="posterior" />
      <log idref="speciescoalescent" />
      <log idref="prior" />
      <log idref="likelihood" />
    </logger>
    <logger fileName="embedding.species.trees" id="treelog:species" logEvery="100" mode="tree">
      <log id="networkLogger:species" spec="speciesnetwork.SpeciesNetworkLogger" speciesNetwork="@network:species" />
    </logger>
    <logger fileName="embedding.gene1.trees" id="treelog:gene1" logEvery="100" mode="tree">
      <log id="treeLogger:gene1" spec="beast.evolution.tree.TreeWithMetaDataLogger" tree="@tree:gene1" />
    </logger>
  </run>
</beast>
