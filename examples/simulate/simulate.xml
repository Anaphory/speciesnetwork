<?xml version='1.0' encoding='UTF-8'?>
<beast namespace="beast.core:beast.evolution.alignment:beast.evolution.tree.coalescent:beast.core.util:beast.evolution.operators:beast.evolution.sitemodel:beast.evolution.substitutionmodel:beast.evolution.likelihood" version="2.0">
    <data id="gene1" name="alignment">
        <sequence id="gene1_a1" taxon="a1" totalcount="4" value="-"/>
        <sequence id="gene1_a2" taxon="a2" totalcount="4" value="-"/>
        <sequence id="gene1_b1" taxon="b1" totalcount="4" value="-"/>
        <sequence id="gene1_b2" taxon="b2" totalcount="4" value="-"/>
        <sequence id="gene1_c1" taxon="c1" totalcount="4" value="-"/>
        <sequence id="gene1_c2" taxon="c2" totalcount="4" value="-"/>
    </data>

    <init spec='beast.util.TreeParser' id='tree:species' IsLabelledNewick="true" adjustTipHeights="false"
          newick="(((A:0.2,(B:0.1)#H1[&amp;gamma=0.5]:0.1)S1:0.3,(#H1:0.2,C:0.3)S2:0.2)R:0.1)"/>
    <stateNode id="network:species" spec="speciesnetwork.NetworkParser" tree="@tree:species">
        <taxonset id="taxonSuperset" spec="TaxonSet">
            <taxon id="A" spec="TaxonSet">
                <taxon id="a1" spec="Taxon"/>
                <taxon id="a2" spec="Taxon"/>
            </taxon>
            <taxon id="B" spec="TaxonSet">
                <taxon id="b1" spec="Taxon"/>
                <taxon id="b2" spec="Taxon"/>
            </taxon>
            <taxon id="C" spec="TaxonSet">
                <taxon id="c1" spec="Taxon"/>
                <taxon id="c2" spec="Taxon"/>
            </taxon>
        </taxonset>
    </stateNode>
    <parameter id="popSizes" estimate="false" name="stateNode">0.01</parameter>

    <siteModel id="siteModel:gene1" mutationRate="1.0" proportionInvariant="0.0" spec="SiteModel">
        <substModel id="jc:gene1" spec="JukesCantor"/>
    </siteModel>
    <branchRateModel clock.rate="1.0" id="clock:gene1" spec="beast.evolution.branchratemodel.StrictClockModel"/>

    <run id="coalSimulator" spec="speciesnetwork.simulator.CoalescentSimulator" outputFileName="sim_3S_1L.trees" iterations="100">
        <speciesNetwork idref="network:species"/>
        <popSizes idref="popSizes"/>
        <taxonSuperset idref="taxonSuperset"/>
        <geneTree idref="tree:gene1"/>
        <embedding idref="embedding:gene1"/>
        <state id="state">
            <tree id="tree:gene1" name="stateNode">
                <taxonset alignment="@gene1" id="taxonset:gene1" spec="TaxonSet"/>
            </tree>
            <stateNode id="embedding:gene1" spec="parameter.IntegerParameter">-1</stateNode>
        </state>
    </run>
</beast>
